---
layout: post
title: "红外寻迹避障电路设计"
author: unknown
layout: post
description: "设计一种反射式光电传感器"
category: 技术分享
tags: 
  - 传感器
  - 电路
---

　　反射式光电传感器在机器人中有着广泛的应用。可以用来检测地面明暗和颜色的变化，也可以探测有无接近的物体。这种光电传感器的基本原理是，自带一个光源和一个光接收装置，光源发出的光经过待测物体的反射被光敏元件接收，再经过相关电路的处理得到所需要的信息。相应的，光谱范围，灵敏度，抗干扰能力，输出特性等都是反射式光电传感器的重要参数。

<!--more-->

##简单比较型光电传感器

<div style="text-align:center"><img src="{{site.img_path}}/2013-12-29 PhotoelectricSensor.png" style="width:451px" alt="比较型光电传感器">
</div>

　　在上左图中，JP1是光电管，接收光强在上面转换成电流，在R上成为电压信号，与RA1的标准值进行比较，从LM339输出逻辑电平给单片机。

　　R越大，光电流产生的电压变化越大，传感器也就越灵敏。但是若R过大，当光比较强的时候，R上的电压会达到VCC而不再变化，这就是所谓的饱和。在这种比较型的传感器电路中，饱和只会使强光与强光难以分辨，但仍可以区分强光和弱光，它并不是影响比较结果的重要因素。但在后面介绍的几种调制型传感器中，饱和是必须避免的，因为它会掩盖交流分量。高灵敏度和饱和是一对矛盾，在后面提到了一些相关的解决方案。

　　LM339是开路输出的，10K的电阻是为了使输出电压正确。如果后面是51之类开路输入的单片机，这个电阻可以省略。

　　假如把光敏管放在下边,电阻放在上边。这样当光线较暗时比较器输入电压接近VCC，超过比较器LM339能够正常工作的最高输入电压Vm,比较器不能正常工作（LM339的共模输入电压最低能低到0，但是最高达不到VCC），因此灵敏度做不高。为了使比较器正常工作，电阻值应使得光照时比较器输入电压Vi大幅下降，满足VCC-I*R<Vm（I是光电流），就是I*R>VCC-Vm。这样，光再强一点，I*R接近VCC,Vi就会降到0附近，光敏管就会饱和，降低了区分颜色的可靠性。

　　而现在把光敏管放在上边,电阻放在下边，就可以解决这个问题：这时Vi=I*R,使用较小的R可以保证Vi<Vm<VCC,不会发生电压范围溢出或者光敏管饱和。这时为了保证光照与输出有相同的逻辑关系（光照时输出低电平，指示灯亮），比较器的同相和反相输入端要互换。

<div style="text-align:center"><img src="{{site.img_path}}/2013-12-29 Constant_current.png" style="width:451px" alt="恒流电路">
</div>

　　上图为给发光管供电的恒流电路(I=0.9V/R1)，恒流的工作过程是：D11起稳压作用，如果电流偏大，R1分压变大，T1的VBE降低，使电流减小；反之亦然。这个负反馈过程使电流恒定，R1上的电压恒定在D11压降和VBE之差，约0.9V。改变R20对地的通断也可以控制发光管的亮灭。这样可以使用很小的R或设置比较高的基准电压，只有很强的光输入才能触发电路。这时在恒流源中三极管的发射极电阻上并联一个电容后，就可以用单片机控制探头照明的LED发出短而强的光脉冲并进行随机调制和解调，提高抗干扰能力，成为调制型传感器电路的一种。

##高通滤波型光电传感器

<div style="text-align:center"><img src="{{site.img_path}}/2013-12-29 High_pass.png" style="width:451px" alt="高通滤波">
</div>

　　光源是用一个脉冲振荡电流去点亮发光二极管，电路图没有画出，可以使用任何一种振荡电路，平均电流根据发光二极管的参数可以取到20mA左右。

　　接收部分是这样工作的:传感器信号先经过CR高通网络去掉直流和低频成分,并加入一个直流offset,也就是一个稳定的直流分量叠加一个交流分量,再与一个设定的直流分量进行比较,如果交流分量的峰值超过offset与设定值之差,比较器就会输出一个方波脉冲,否则输出0;然后通过RC低通网络,使方波脉冲的交流分量尽可能的减小,变成某个直流电压V(>0),再与另一个设定值(<V)比较,输出低电平.如果没有交流输入,第一级比较器输出0,第二级比较器输出高电平,如下表所示:（仿真结果）

![仿真结果1]({{ site.img_path }}/2013-12-29 simulation1.png)  ![仿真结果2]({{ site.img_path }}/2013-12-29 simulation2.png)

![仿真结果3]({{ site.img_path }}/2013-12-29 simulation3.png)  ![仿真结果4]({{ site.img_path }}/2013-12-29 simulation4.png)

<table>
<tr>
    <th>
    	![仿真结果1]({{ site.img_path }}/2013-12-29 simulation1.png)
    </th>
    <th>
    	![仿真结果2]({{ site.img_path }}/2013-12-29 simulation2.png)
    </th>
</tr>
<tr>
    <th>
    	![仿真结果3]({{ site.img_path }}/2013-12-29 simulation3.png)
    </th>
    <th>
    	![仿真结果4]({{ site.img_path }}/2013-12-29 simulation4.png)
    </th>
</tr>
</table>

　　这种电路可以在未饱和的情况下抵御外界非交流光以及瞬间光（如闪光灯）的干扰，但收到高频光的干扰时会产生误动作。

##使用LM567的调制传感器

　　LM567是一种廉价的音频锁相环集成电路，利用它可以构造性能较好的反射式光电传感器。

　　如下页图所示，由LM567的内部振荡器提供方波信号，点亮探头的LED，由探头的光敏管接收反射光。经三极管放大，转换成电压信号后送到LM567的内部鉴相器2（输出鉴相器）同步解调，然后由LM567内部的比较器转换为数字输出。

　　并联负反馈放大电路有着稳定的增益和低的输入阻抗，能消除光敏管结电容的影响，获得良好的高频特性。
　　200K电位器（R6,200K adjustable） 用于调节放大器增益以调节灵敏度。

　　在outi和outo之间的510K电阻和1000p电容用于给比较器添加50mV的滞回，消除调制频率纹波造成的输出抖动。其中1000p电容的作用是补偿C1的影响，加快输出跳变。

　　这个电路的缺点是当多个探头同时使用时因为频率接近，一旦相邻单元的光斑出现部分重合就会有差拍干扰造成输出抖动。另外，567输出鉴相器的参考信号是从振荡电容端引出的，与发射和接收信号几乎是正交的，解调效率非常低，前级需要高倍放大。



<br/>

<br/>

